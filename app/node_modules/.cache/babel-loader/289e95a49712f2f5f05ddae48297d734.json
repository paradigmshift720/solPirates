{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\parad\\\\documents\\\\nft\\\\nft-drop-starter-project\\\\app\\\\src\\\\CandyMachine\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Connection, PublicKey } from '@solana/web3.js';\nimport { Program, Provider, web3 } from '@project-serum/anchor';\nimport { MintLayout, TOKEN_PROGRAM_ID, Token } from '@solana/spl-token';\nimport { programs } from '@metaplex/js';\nimport './CandyMachine.css';\nimport CountdownTimer from '../CountdownTimer';\nimport { candyMachineProgram, TOKEN_METADATA_PROGRAM_ID, SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID } from './helpers';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  metadata: {\n    Metadata,\n    MetadataProgram\n  }\n} = programs;\nconst config = new web3.PublicKey(process.env.REACT_APP_CANDY_MACHINE_CONFIG);\nconst {\n  SystemProgram\n} = web3;\nconst opts = {\n  preflightCommitment: 'processed'\n};\nconst MAX_NAME_LENGTH = 32;\nconst MAX_URI_LENGTH = 200;\nconst MAX_SYMBOL_LENGTH = 10;\nconst MAX_CREATOR_LEN = 32 + 1 + 1;\n\nconst CandyMachine = _ref => {\n  _s();\n\n  let {\n    walletAddress\n  } = _ref;\n  const [machineStats, setMachineStats] = useState(null);\n  const [mints, setMints] = useState([]);\n  const [isMinting, setIsMinting] = useState(false);\n  const [isLoadingMints, setIsLoadingMints] = useState(false); // Actions\n\n  useEffect(() => {\n    getCandyMachineState();\n  }, []);\n\n  const getProvider = () => {\n    const rpcHost = process.env.REACT_APP_SOLANA_RPC_HOST; // Create a new connection object\n\n    const connection = new Connection(rpcHost); // Create a new Solana provider object\n\n    const provider = new Provider(connection, window.solana, opts.preflightCommitment);\n    return provider;\n  }; // Declare getCandyMachineState as an async method\n\n\n  const getCandyMachineState = async () => {\n    const provider = getProvider(); // Get metadata about your deployed candy machine program\n\n    const idl = await Program.fetchIdl(candyMachineProgram, provider); // Create a program that you can call\n\n    const program = new Program(idl, candyMachineProgram, provider); // Fetch the metadata from your candy machine\n\n    const candyMachine = await program.account.candyMachine.fetch(process.env.REACT_APP_CANDY_MACHINE_ID); // Parse out all our metadata and log it out\n\n    const itemsAvailable = candyMachine.data.itemsAvailable.toNumber();\n    const itemsRedeemed = candyMachine.itemsRedeemed.toNumber();\n    const itemsRemaining = itemsAvailable - itemsRedeemed;\n    const goLiveData = candyMachine.data.goLiveDate.toNumber(); // We will be using this later in our UI so let's generate this now\n\n    const goLiveDateTimeString = `${new Date(goLiveData * 1000).toLocaleDateString()} @ ${new Date(goLiveData * 1000).toLocaleTimeString()}`;\n    setMachineStats({\n      itemsAvailable,\n      itemsRedeemed,\n      itemsRemaining,\n      goLiveData,\n      goLiveDateTimeString\n    });\n    console.log({\n      itemsAvailable,\n      itemsRedeemed,\n      itemsRemaining,\n      goLiveData,\n      goLiveDateTimeString\n    });\n    setIsLoadingMints(true);\n    const data = await fetchHashTable(process.env.REACT_APP_CANDY_MACHINE_ID, true);\n\n    if (data.length !== 0) {\n      for (const mint of data) {\n        // Get URI\n        const response = await fetch(mint.data.uri);\n        const parse = await response.json();\n        console.log(\"Past Minted NFT\", mint); // Get image URI\n\n        if (!mints.find(mint => mint === parse.image)) {\n          setMints(prevState => [...prevState, parse.image]);\n        }\n      }\n    }\n\n    setIsLoadingMints(false);\n  };\n\n  const fetchHashTable = async (hash, metadataEnabled) => {\n    const connection = new web3.Connection(process.env.REACT_APP_SOLANA_RPC_HOST);\n    const metadataAccounts = await MetadataProgram.getProgramAccounts(connection, {\n      filters: [{\n        memcmp: {\n          offset: 1 + 32 + 32 + 4 + MAX_NAME_LENGTH + 4 + MAX_URI_LENGTH + 4 + MAX_SYMBOL_LENGTH + 2 + 1 + 4 + 0 * MAX_CREATOR_LEN,\n          bytes: hash\n        }\n      }]\n    });\n    const mintHashes = [];\n\n    for (let index = 0; index < metadataAccounts.length; index++) {\n      const account = metadataAccounts[index];\n      const accountInfo = await connection.getParsedAccountInfo(account.pubkey);\n      const metadata = new Metadata(hash.toString(), accountInfo.value);\n      if (metadataEnabled) mintHashes.push(metadata.data);else mintHashes.push(metadata.data.mint);\n    }\n\n    return mintHashes;\n  };\n\n  const getMetadata = async mint => {\n    return (await PublicKey.findProgramAddress([Buffer.from('metadata'), TOKEN_METADATA_PROGRAM_ID.toBuffer(), mint.toBuffer()], TOKEN_METADATA_PROGRAM_ID))[0];\n  };\n\n  const getMasterEdition = async mint => {\n    return (await PublicKey.findProgramAddress([Buffer.from('metadata'), TOKEN_METADATA_PROGRAM_ID.toBuffer(), mint.toBuffer(), Buffer.from('edition')], TOKEN_METADATA_PROGRAM_ID))[0];\n  };\n\n  const getTokenWallet = async (wallet, mint) => {\n    return (await web3.PublicKey.findProgramAddress([wallet.toBuffer(), TOKEN_PROGRAM_ID.toBuffer(), mint.toBuffer()], SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID))[0];\n  };\n\n  const mintToken = async () => {\n    try {\n      setIsMinting(true);\n      const mint = web3.Keypair.generate();\n      const token = await getTokenWallet(walletAddress.publicKey, mint.publicKey);\n      const metadata = await getMetadata(mint.publicKey);\n      const masterEdition = await getMasterEdition(mint.publicKey);\n      const rpcHost = process.env.REACT_APP_SOLANA_RPC_HOST;\n      const connection = new Connection(rpcHost);\n      const rent = await connection.getMinimumBalanceForRentExemption(MintLayout.span);\n      const accounts = {\n        config,\n        candyMachine: process.env.REACT_APP_CANDY_MACHINE_ID,\n        payer: walletAddress.publicKey,\n        wallet: process.env.REACT_APP_TREASURY_ADDRESS,\n        mint: mint.publicKey,\n        metadata,\n        masterEdition,\n        mintAuthority: walletAddress.publicKey,\n        updateAuthority: walletAddress.publicKey,\n        tokenMetadataProgram: TOKEN_METADATA_PROGRAM_ID,\n        tokenProgram: TOKEN_PROGRAM_ID,\n        systemProgram: SystemProgram.programId,\n        rent: web3.SYSVAR_RENT_PUBKEY,\n        clock: web3.SYSVAR_CLOCK_PUBKEY\n      };\n      const signers = [mint];\n      const instructions = [web3.SystemProgram.createAccount({\n        fromPubkey: walletAddress.publicKey,\n        newAccountPubkey: mint.publicKey,\n        space: MintLayout.span,\n        lamports: rent,\n        programId: TOKEN_PROGRAM_ID\n      }), Token.createInitMintInstruction(TOKEN_PROGRAM_ID, mint.publicKey, 0, walletAddress.publicKey, walletAddress.publicKey), createAssociatedTokenAccountInstruction(token, walletAddress.publicKey, walletAddress.publicKey, mint.publicKey), Token.createMintToInstruction(TOKEN_PROGRAM_ID, mint.publicKey, token, walletAddress.publicKey, [], 1)];\n      const provider = getProvider();\n      const idl = await Program.fetchIdl(candyMachineProgram, provider);\n      const program = new Program(idl, candyMachineProgram, provider);\n      const txn = await program.rpc.mintNft({\n        accounts,\n        signers,\n        instructions\n      });\n      console.log('txn:', txn); // Setup listener\n\n      connection.onSignatureWithOptions(txn, async (notification, context) => {\n        if (notification.type === 'status') {\n          console.log('Receievd status event');\n          const {\n            result\n          } = notification;\n\n          if (!result.err) {\n            console.log('NFT Minted!');\n            setIsMinting(false);\n            await getCandyMachineState();\n          }\n        }\n      }, {\n        commitment: 'processed'\n      });\n    } catch (error) {\n      let message = error.msg || 'Minting failed! Please try again!';\n      setIsMinting(false);\n\n      if (!error.msg) {\n        if (error.message.indexOf('0x138')) {} else if (error.message.indexOf('0x137')) {\n          message = `SOLD OUT!`;\n        } else if (error.message.indexOf('0x135')) {\n          message = `Insufficient funds to mint. Please fund your wallet.`;\n        }\n      } else {\n        if (error.code === 311) {\n          message = `SOLD OUT!`;\n        } else if (error.code === 312) {\n          message = `Minting period hasn't started yet.`;\n        }\n      }\n\n      console.warn(message);\n    }\n  };\n\n  const createAssociatedTokenAccountInstruction = (associatedTokenAddress, payer, walletAddress, splTokenMintAddress) => {\n    const keys = [{\n      pubkey: payer,\n      isSigner: true,\n      isWritable: true\n    }, {\n      pubkey: associatedTokenAddress,\n      isSigner: false,\n      isWritable: true\n    }, {\n      pubkey: walletAddress,\n      isSigner: false,\n      isWritable: false\n    }, {\n      pubkey: splTokenMintAddress,\n      isSigner: false,\n      isWritable: false\n    }, {\n      pubkey: web3.SystemProgram.programId,\n      isSigner: false,\n      isWritable: false\n    }, {\n      pubkey: TOKEN_PROGRAM_ID,\n      isSigner: false,\n      isWritable: false\n    }, {\n      pubkey: web3.SYSVAR_RENT_PUBKEY,\n      isSigner: false,\n      isWritable: false\n    }];\n    return new web3.TransactionInstruction({\n      keys,\n      programId: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n      data: Buffer.from([])\n    });\n  };\n\n  const renderMintedItems = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"gif-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"sub-text\",\n      children: \"Minted Items \\u2728\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"gif-grid\",\n      children: mints.map(mint => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"gif-item\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: mint,\n          alt: `Minted NFT ${mint}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this)\n      }, mint, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 351,\n    columnNumber: 5\n  }, this);\n\n  const renderDropTimer = () => {\n    // Get the current date and dropDate in a JavaScript Date object\n    const currentDate = new Date();\n    const dropDate = new Date(machineStats.goLiveData * 1000); // If currentDate is before dropDate, render our Countdown component\n\n    if (currentDate < dropDate) {\n      return /*#__PURE__*/_jsxDEV(CountdownTimer, {\n        dropDate: dropDate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 12\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: `Drop Date: ${machineStats.goLiveDateTimeString}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 12\n    }, this);\n  };\n\n  return machineStats && /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"machine-container\",\n    children: [renderDropTimer(), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: `Items Minted: ${machineStats.itemsRedeemed} / ${machineStats.itemsAvailable}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 9\n    }, this), machineStats.itemsRedeemed === machineStats.itemsAvailable ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"sub-text\",\n      children: \"Sold Out \\uD83D\\uDE4A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"cta-button mint-button\",\n      onClick: mintToken,\n      disabled: isMinting,\n      children: \"Mint NFT\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 11\n    }, this), isLoadingMints && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"LOADING MINTS...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 28\n    }, this), mints.length > 0 && renderMintedItems()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 377,\n    columnNumber: 7\n  }, this);\n};\n\n_s(CandyMachine, \"sVNp0t+sWePLadR0tcswzzFeABU=\");\n\n_c = CandyMachine;\nexport default CandyMachine;\n\nvar _c;\n\n$RefreshReg$(_c, \"CandyMachine\");","map":{"version":3,"sources":["C:/Users/parad/documents/nft/nft-drop-starter-project/app/src/CandyMachine/index.js"],"names":["React","useEffect","useState","Connection","PublicKey","Program","Provider","web3","MintLayout","TOKEN_PROGRAM_ID","Token","programs","CountdownTimer","candyMachineProgram","TOKEN_METADATA_PROGRAM_ID","SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID","metadata","Metadata","MetadataProgram","config","process","env","REACT_APP_CANDY_MACHINE_CONFIG","SystemProgram","opts","preflightCommitment","MAX_NAME_LENGTH","MAX_URI_LENGTH","MAX_SYMBOL_LENGTH","MAX_CREATOR_LEN","CandyMachine","walletAddress","machineStats","setMachineStats","mints","setMints","isMinting","setIsMinting","isLoadingMints","setIsLoadingMints","getCandyMachineState","getProvider","rpcHost","REACT_APP_SOLANA_RPC_HOST","connection","provider","window","solana","idl","fetchIdl","program","candyMachine","account","fetch","REACT_APP_CANDY_MACHINE_ID","itemsAvailable","data","toNumber","itemsRedeemed","itemsRemaining","goLiveData","goLiveDate","goLiveDateTimeString","Date","toLocaleDateString","toLocaleTimeString","console","log","fetchHashTable","length","mint","response","uri","parse","json","find","image","prevState","hash","metadataEnabled","metadataAccounts","getProgramAccounts","filters","memcmp","offset","bytes","mintHashes","index","accountInfo","getParsedAccountInfo","pubkey","toString","value","push","getMetadata","findProgramAddress","Buffer","from","toBuffer","getMasterEdition","getTokenWallet","wallet","mintToken","Keypair","generate","token","publicKey","masterEdition","rent","getMinimumBalanceForRentExemption","span","accounts","payer","REACT_APP_TREASURY_ADDRESS","mintAuthority","updateAuthority","tokenMetadataProgram","tokenProgram","systemProgram","programId","SYSVAR_RENT_PUBKEY","clock","SYSVAR_CLOCK_PUBKEY","signers","instructions","createAccount","fromPubkey","newAccountPubkey","space","lamports","createInitMintInstruction","createAssociatedTokenAccountInstruction","createMintToInstruction","txn","rpc","mintNft","onSignatureWithOptions","notification","context","type","result","err","commitment","error","message","msg","indexOf","code","warn","associatedTokenAddress","splTokenMintAddress","keys","isSigner","isWritable","TransactionInstruction","renderMintedItems","map","renderDropTimer","currentDate","dropDate"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,iBAAtC;AACA,SAASC,OAAT,EAAkBC,QAAlB,EAA4BC,IAA5B,QAAwC,uBAAxC;AACA,SAASC,UAAT,EAAqBC,gBAArB,EAAuCC,KAAvC,QAAoD,mBAApD;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAO,oBAAP;AACA,OAAOC,cAAP,MAA2B,mBAA3B;AACA,SACEC,mBADF,EAEEC,yBAFF,EAGEC,uCAHF,QAIO,WAJP;;AAKA,MAAM;AACJC,EAAAA,QAAQ,EAAE;AAAEC,IAAAA,QAAF;AAAYC,IAAAA;AAAZ;AADN,IAEFP,QAFJ;AAIA,MAAMQ,MAAM,GAAG,IAAIZ,IAAI,CAACH,SAAT,CAAmBgB,OAAO,CAACC,GAAR,CAAYC,8BAA/B,CAAf;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAoBhB,IAA1B;AACA,MAAMiB,IAAI,GAAG;AACXC,EAAAA,mBAAmB,EAAE;AADV,CAAb;AAIA,MAAMC,eAAe,GAAG,EAAxB;AACA,MAAMC,cAAc,GAAG,GAAvB;AACA,MAAMC,iBAAiB,GAAG,EAA1B;AACA,MAAMC,eAAe,GAAG,KAAK,CAAL,GAAS,CAAjC;;AAIA,MAAMC,YAAY,GAAG,QAAuB;AAAA;;AAAA,MAAtB;AAAEC,IAAAA;AAAF,GAAsB;AAC1C,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkC/B,QAAQ,CAAC,IAAD,CAAhD;AACA,QAAM,CAACgC,KAAD,EAAQC,QAAR,IAAoBjC,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACkC,SAAD,EAAYC,YAAZ,IAA4BnC,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACoC,cAAD,EAAiBC,iBAAjB,IAAsCrC,QAAQ,CAAC,KAAD,CAApD,CAJ0C,CAM1C;;AACAD,EAAAA,SAAS,CAAC,MAAM;AACduC,IAAAA,oBAAoB;AACrB,GAFQ,EAEN,EAFM,CAAT;;AAIA,QAAMC,WAAW,GAAG,MAAM;AACxB,UAAMC,OAAO,GAAGtB,OAAO,CAACC,GAAR,CAAYsB,yBAA5B,CADwB,CAExB;;AACA,UAAMC,UAAU,GAAG,IAAIzC,UAAJ,CAAeuC,OAAf,CAAnB,CAHwB,CAKxB;;AACA,UAAMG,QAAQ,GAAG,IAAIvC,QAAJ,CACfsC,UADe,EAEfE,MAAM,CAACC,MAFQ,EAGfvB,IAAI,CAACC,mBAHU,CAAjB;AAMA,WAAOoB,QAAP;AACD,GAbD,CAX0C,CA2B1C;;;AACF,QAAML,oBAAoB,GAAG,YAAY;AACvC,UAAMK,QAAQ,GAAGJ,WAAW,EAA5B,CADuC,CAEvC;;AACA,UAAMO,GAAG,GAAG,MAAM3C,OAAO,CAAC4C,QAAR,CAAiBpC,mBAAjB,EAAsCgC,QAAtC,CAAlB,CAHuC,CAIvC;;AACA,UAAMK,OAAO,GAAG,IAAI7C,OAAJ,CAAY2C,GAAZ,EAAiBnC,mBAAjB,EAAsCgC,QAAtC,CAAhB,CALuC,CAMvC;;AACA,UAAMM,YAAY,GAAG,MAAMD,OAAO,CAACE,OAAR,CAAgBD,YAAhB,CAA6BE,KAA7B,CACzBjC,OAAO,CAACC,GAAR,CAAYiC,0BADa,CAA3B,CAPuC,CAWvC;;AACA,UAAMC,cAAc,GAAGJ,YAAY,CAACK,IAAb,CAAkBD,cAAlB,CAAiCE,QAAjC,EAAvB;AACA,UAAMC,aAAa,GAAGP,YAAY,CAACO,aAAb,CAA2BD,QAA3B,EAAtB;AACA,UAAME,cAAc,GAAGJ,cAAc,GAAGG,aAAxC;AACA,UAAME,UAAU,GAAGT,YAAY,CAACK,IAAb,CAAkBK,UAAlB,CAA6BJ,QAA7B,EAAnB,CAfuC,CAiBvC;;AACA,UAAMK,oBAAoB,GAAI,GAAE,IAAIC,IAAJ,CAC9BH,UAAU,GAAG,IADiB,EAE9BI,kBAF8B,EAET,MAAK,IAAID,IAAJ,CAC1BH,UAAU,GAAG,IADa,EAE1BK,kBAF0B,EAEL,EAJvB;AAMAhC,IAAAA,eAAe,CAAC;AACdsB,MAAAA,cADc;AAEdG,MAAAA,aAFc;AAGdC,MAAAA,cAHc;AAIdC,MAAAA,UAJc;AAKdE,MAAAA;AALc,KAAD,CAAf;AAQAI,IAAAA,OAAO,CAACC,GAAR,CAAY;AACVZ,MAAAA,cADU;AAEVG,MAAAA,aAFU;AAGVC,MAAAA,cAHU;AAIVC,MAAAA,UAJU;AAKVE,MAAAA;AALU,KAAZ;AAQAvB,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AAEA,UAAMiB,IAAI,GAAG,MAAMY,cAAc,CAC/BhD,OAAO,CAACC,GAAR,CAAYiC,0BADmB,EAE/B,IAF+B,CAAjC;;AAKA,QAAIE,IAAI,CAACa,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAK,MAAMC,IAAX,IAAmBd,IAAnB,EAAyB;AACvB;AACA,cAAMe,QAAQ,GAAG,MAAMlB,KAAK,CAACiB,IAAI,CAACd,IAAL,CAAUgB,GAAX,CAA5B;AACA,cAAMC,KAAK,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAApB;AACAR,QAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BG,IAA/B,EAJuB,CAMvB;;AACA,YAAI,CAACpC,KAAK,CAACyC,IAAN,CAAYL,IAAD,IAAUA,IAAI,KAAKG,KAAK,CAACG,KAApC,CAAL,EAAiD;AAC/CzC,UAAAA,QAAQ,CAAE0C,SAAD,IAAe,CAAC,GAAGA,SAAJ,EAAeJ,KAAK,CAACG,KAArB,CAAhB,CAAR;AACD;AACF;AACF;;AAEDrC,IAAAA,iBAAiB,CAAC,KAAD,CAAjB;AAED,GA/DD;;AAiEE,QAAM6B,cAAc,GAAG,OAAOU,IAAP,EAAaC,eAAb,KAAiC;AACtD,UAAMnC,UAAU,GAAG,IAAIrC,IAAI,CAACJ,UAAT,CACjBiB,OAAO,CAACC,GAAR,CAAYsB,yBADK,CAAnB;AAIA,UAAMqC,gBAAgB,GAAG,MAAM9D,eAAe,CAAC+D,kBAAhB,CAC7BrC,UAD6B,EAE7B;AACEsC,MAAAA,OAAO,EAAE,CACP;AACEC,QAAAA,MAAM,EAAE;AACNC,UAAAA,MAAM,EACJ,IACA,EADA,GAEA,EAFA,GAGA,CAHA,GAIA1D,eAJA,GAKA,CALA,GAMAC,cANA,GAOA,CAPA,GAQAC,iBARA,GASA,CATA,GAUA,CAVA,GAWA,CAXA,GAYA,IAAIC,eAdA;AAeNwD,UAAAA,KAAK,EAAEP;AAfD;AADV,OADO;AADX,KAF6B,CAA/B;AA2BA,UAAMQ,UAAU,GAAG,EAAnB;;AAEA,SAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGP,gBAAgB,CAACX,MAA7C,EAAqDkB,KAAK,EAA1D,EAA8D;AAC5D,YAAMnC,OAAO,GAAG4B,gBAAgB,CAACO,KAAD,CAAhC;AACA,YAAMC,WAAW,GAAG,MAAM5C,UAAU,CAAC6C,oBAAX,CAAgCrC,OAAO,CAACsC,MAAxC,CAA1B;AACA,YAAM1E,QAAQ,GAAG,IAAIC,QAAJ,CAAa6D,IAAI,CAACa,QAAL,EAAb,EAA8BH,WAAW,CAACI,KAA1C,CAAjB;AACA,UAAIb,eAAJ,EAAqBO,UAAU,CAACO,IAAX,CAAgB7E,QAAQ,CAACwC,IAAzB,EAArB,KACK8B,UAAU,CAACO,IAAX,CAAgB7E,QAAQ,CAACwC,IAAT,CAAcc,IAA9B;AACN;;AAED,WAAOgB,UAAP;AACD,GA3CD;;AA6CA,QAAMQ,WAAW,GAAG,MAAOxB,IAAP,IAAgB;AAClC,WAAO,CACL,MAAMlE,SAAS,CAAC2F,kBAAV,CACJ,CACEC,MAAM,CAACC,IAAP,CAAY,UAAZ,CADF,EAEEnF,yBAAyB,CAACoF,QAA1B,EAFF,EAGE5B,IAAI,CAAC4B,QAAL,EAHF,CADI,EAMJpF,yBANI,CADD,EASL,CATK,CAAP;AAUD,GAXD;;AAaA,QAAMqF,gBAAgB,GAAG,MAAO7B,IAAP,IAAgB;AACvC,WAAO,CACL,MAAMlE,SAAS,CAAC2F,kBAAV,CACJ,CACEC,MAAM,CAACC,IAAP,CAAY,UAAZ,CADF,EAEEnF,yBAAyB,CAACoF,QAA1B,EAFF,EAGE5B,IAAI,CAAC4B,QAAL,EAHF,EAIEF,MAAM,CAACC,IAAP,CAAY,SAAZ,CAJF,CADI,EAOJnF,yBAPI,CADD,EAUL,CAVK,CAAP;AAWD,GAZD;;AAcA,QAAMsF,cAAc,GAAG,OAAOC,MAAP,EAAe/B,IAAf,KAAwB;AAC7C,WAAO,CACL,MAAM/D,IAAI,CAACH,SAAL,CAAe2F,kBAAf,CACJ,CAACM,MAAM,CAACH,QAAP,EAAD,EAAoBzF,gBAAgB,CAACyF,QAAjB,EAApB,EAAiD5B,IAAI,CAAC4B,QAAL,EAAjD,CADI,EAEJnF,uCAFI,CADD,EAKL,CALK,CAAP;AAMD,GAPD;;AASA,QAAMuF,SAAS,GAAG,YAAY;AAC5B,QAAI;AACFjE,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACA,YAAMiC,IAAI,GAAG/D,IAAI,CAACgG,OAAL,CAAaC,QAAb,EAAb;AACA,YAAMC,KAAK,GAAG,MAAML,cAAc,CAChCrE,aAAa,CAAC2E,SADkB,EAEhCpC,IAAI,CAACoC,SAF2B,CAAlC;AAIA,YAAM1F,QAAQ,GAAG,MAAM8E,WAAW,CAACxB,IAAI,CAACoC,SAAN,CAAlC;AACA,YAAMC,aAAa,GAAG,MAAMR,gBAAgB,CAAC7B,IAAI,CAACoC,SAAN,CAA5C;AACA,YAAMhE,OAAO,GAAGtB,OAAO,CAACC,GAAR,CAAYsB,yBAA5B;AACA,YAAMC,UAAU,GAAG,IAAIzC,UAAJ,CAAeuC,OAAf,CAAnB;AACA,YAAMkE,IAAI,GAAG,MAAMhE,UAAU,CAACiE,iCAAX,CACjBrG,UAAU,CAACsG,IADM,CAAnB;AAIA,YAAMC,QAAQ,GAAG;AACf5F,QAAAA,MADe;AAEfgC,QAAAA,YAAY,EAAE/B,OAAO,CAACC,GAAR,CAAYiC,0BAFX;AAGf0D,QAAAA,KAAK,EAAEjF,aAAa,CAAC2E,SAHN;AAIfL,QAAAA,MAAM,EAAEjF,OAAO,CAACC,GAAR,CAAY4F,0BAJL;AAKf3C,QAAAA,IAAI,EAAEA,IAAI,CAACoC,SALI;AAMf1F,QAAAA,QANe;AAOf2F,QAAAA,aAPe;AAQfO,QAAAA,aAAa,EAAEnF,aAAa,CAAC2E,SARd;AASfS,QAAAA,eAAe,EAAEpF,aAAa,CAAC2E,SAThB;AAUfU,QAAAA,oBAAoB,EAAEtG,yBAVP;AAWfuG,QAAAA,YAAY,EAAE5G,gBAXC;AAYf6G,QAAAA,aAAa,EAAE/F,aAAa,CAACgG,SAZd;AAafX,QAAAA,IAAI,EAAErG,IAAI,CAACiH,kBAbI;AAcfC,QAAAA,KAAK,EAAElH,IAAI,CAACmH;AAdG,OAAjB;AAiBA,YAAMC,OAAO,GAAG,CAACrD,IAAD,CAAhB;AACA,YAAMsD,YAAY,GAAG,CACnBrH,IAAI,CAACgB,aAAL,CAAmBsG,aAAnB,CAAiC;AAC/BC,QAAAA,UAAU,EAAE/F,aAAa,CAAC2E,SADK;AAE/BqB,QAAAA,gBAAgB,EAAEzD,IAAI,CAACoC,SAFQ;AAG/BsB,QAAAA,KAAK,EAAExH,UAAU,CAACsG,IAHa;AAI/BmB,QAAAA,QAAQ,EAAErB,IAJqB;AAK/BW,QAAAA,SAAS,EAAE9G;AALoB,OAAjC,CADmB,EAQnBC,KAAK,CAACwH,yBAAN,CACEzH,gBADF,EAEE6D,IAAI,CAACoC,SAFP,EAGE,CAHF,EAIE3E,aAAa,CAAC2E,SAJhB,EAKE3E,aAAa,CAAC2E,SALhB,CARmB,EAenByB,uCAAuC,CACrC1B,KADqC,EAErC1E,aAAa,CAAC2E,SAFuB,EAGrC3E,aAAa,CAAC2E,SAHuB,EAIrCpC,IAAI,CAACoC,SAJgC,CAfpB,EAqBnBhG,KAAK,CAAC0H,uBAAN,CACE3H,gBADF,EAEE6D,IAAI,CAACoC,SAFP,EAGED,KAHF,EAIE1E,aAAa,CAAC2E,SAJhB,EAKE,EALF,EAME,CANF,CArBmB,CAArB;AA+BA,YAAM7D,QAAQ,GAAGJ,WAAW,EAA5B;AACA,YAAMO,GAAG,GAAG,MAAM3C,OAAO,CAAC4C,QAAR,CAAiBpC,mBAAjB,EAAsCgC,QAAtC,CAAlB;AACA,YAAMK,OAAO,GAAG,IAAI7C,OAAJ,CAAY2C,GAAZ,EAAiBnC,mBAAjB,EAAsCgC,QAAtC,CAAhB;AAEA,YAAMwF,GAAG,GAAG,MAAMnF,OAAO,CAACoF,GAAR,CAAYC,OAAZ,CAAoB;AACpCxB,QAAAA,QADoC;AAEpCY,QAAAA,OAFoC;AAGpCC,QAAAA;AAHoC,OAApB,CAAlB;AAMA1D,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBkE,GAApB,EA1EE,CA4EF;;AACAzF,MAAAA,UAAU,CAAC4F,sBAAX,CACEH,GADF,EAEE,OAAOI,YAAP,EAAqBC,OAArB,KAAiC;AAC/B,YAAID,YAAY,CAACE,IAAb,KAAsB,QAA1B,EAAoC;AAClCzE,UAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AAEA,gBAAM;AAAEyE,YAAAA;AAAF,cAAaH,YAAnB;;AACA,cAAI,CAACG,MAAM,CAACC,GAAZ,EAAiB;AACf3E,YAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA9B,YAAAA,YAAY,CAAC,KAAD,CAAZ;AACA,kBAAMG,oBAAoB,EAA1B;AACD;AACF;AACF,OAbH,EAcE;AAAEsG,QAAAA,UAAU,EAAE;AAAd,OAdF;AAgBD,KA7FD,CA6FE,OAAOC,KAAP,EAAc;AACd,UAAIC,OAAO,GAAGD,KAAK,CAACE,GAAN,IAAa,mCAA3B;AACA5G,MAAAA,YAAY,CAAC,KAAD,CAAZ;;AACA,UAAI,CAAC0G,KAAK,CAACE,GAAX,EAAgB;AACd,YAAIF,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,OAAtB,CAAJ,EAAoC,CACnC,CADD,MACO,IAAIH,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,OAAtB,CAAJ,EAAoC;AACzCF,UAAAA,OAAO,GAAI,WAAX;AACD,SAFM,MAEA,IAAID,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,OAAtB,CAAJ,EAAoC;AACzCF,UAAAA,OAAO,GAAI,sDAAX;AACD;AACF,OAPD,MAOO;AACL,YAAID,KAAK,CAACI,IAAN,KAAe,GAAnB,EAAwB;AACtBH,UAAAA,OAAO,GAAI,WAAX;AACD,SAFD,MAEO,IAAID,KAAK,CAACI,IAAN,KAAe,GAAnB,EAAwB;AAC7BH,UAAAA,OAAO,GAAI,oCAAX;AACD;AACF;;AAED9E,MAAAA,OAAO,CAACkF,IAAR,CAAaJ,OAAb;AACD;AACF,GAlHD;;AAoHA,QAAMb,uCAAuC,GAAG,CAC9CkB,sBAD8C,EAE9CrC,KAF8C,EAG9CjF,aAH8C,EAI9CuH,mBAJ8C,KAK3C;AACH,UAAMC,IAAI,GAAG,CACX;AAAE7D,MAAAA,MAAM,EAAEsB,KAAV;AAAiBwC,MAAAA,QAAQ,EAAE,IAA3B;AAAiCC,MAAAA,UAAU,EAAE;AAA7C,KADW,EAEX;AAAE/D,MAAAA,MAAM,EAAE2D,sBAAV;AAAkCG,MAAAA,QAAQ,EAAE,KAA5C;AAAmDC,MAAAA,UAAU,EAAE;AAA/D,KAFW,EAGX;AAAE/D,MAAAA,MAAM,EAAE3D,aAAV;AAAyByH,MAAAA,QAAQ,EAAE,KAAnC;AAA0CC,MAAAA,UAAU,EAAE;AAAtD,KAHW,EAIX;AAAE/D,MAAAA,MAAM,EAAE4D,mBAAV;AAA+BE,MAAAA,QAAQ,EAAE,KAAzC;AAAgDC,MAAAA,UAAU,EAAE;AAA5D,KAJW,EAKX;AACE/D,MAAAA,MAAM,EAAEnF,IAAI,CAACgB,aAAL,CAAmBgG,SAD7B;AAEEiC,MAAAA,QAAQ,EAAE,KAFZ;AAGEC,MAAAA,UAAU,EAAE;AAHd,KALW,EAUX;AAAE/D,MAAAA,MAAM,EAAEjF,gBAAV;AAA4B+I,MAAAA,QAAQ,EAAE,KAAtC;AAA6CC,MAAAA,UAAU,EAAE;AAAzD,KAVW,EAWX;AACE/D,MAAAA,MAAM,EAAEnF,IAAI,CAACiH,kBADf;AAEEgC,MAAAA,QAAQ,EAAE,KAFZ;AAGEC,MAAAA,UAAU,EAAE;AAHd,KAXW,CAAb;AAiBA,WAAO,IAAIlJ,IAAI,CAACmJ,sBAAT,CAAgC;AACrCH,MAAAA,IADqC;AAErChC,MAAAA,SAAS,EAAExG,uCAF0B;AAGrCyC,MAAAA,IAAI,EAAEwC,MAAM,CAACC,IAAP,CAAY,EAAZ;AAH+B,KAAhC,CAAP;AAKD,GA5BD;;AA8BA,QAAM0D,iBAAiB,GAAG,mBACxB;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA,4BACE;AAAG,MAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA,gBACGzH,KAAK,CAAC0H,GAAN,CAAWtF,IAAD,iBACT;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA,+BACE;AAAK,UAAA,GAAG,EAAEA,IAAV;AAAgB,UAAA,GAAG,EAAG,cAAaA,IAAK;AAAxC;AAAA;AAAA;AAAA;AAAA;AADF,SAA+BA,IAA/B;AAAA;AAAA;AAAA;AAAA,cADD;AADH;AAAA;AAAA;AAAA;AAAA,YAFF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;;AAaF,QAAMuF,eAAe,GAAG,MAAM;AAC5B;AACA,UAAMC,WAAW,GAAG,IAAI/F,IAAJ,EAApB;AACA,UAAMgG,QAAQ,GAAG,IAAIhG,IAAJ,CAAS/B,YAAY,CAAC4B,UAAb,GAA0B,IAAnC,CAAjB,CAH4B,CAK5B;;AACA,QAAIkG,WAAW,GAAGC,QAAlB,EAA4B;AAC1B,0BAAO,QAAC,cAAD;AAAgB,QAAA,QAAQ,EAAEA;AAA1B;AAAA;AAAA;AAAA;AAAA,cAAP;AACD;;AACC,wBAAO;AAAA,gBAAK,cAAa/H,YAAY,CAAC8B,oBAAqB;AAApD;AAAA;AAAA;AAAA;AAAA,YAAP;AACD,GAVH;;AAYE,SACE9B,YAAY,iBACV;AAAK,IAAA,SAAS,EAAC,mBAAf;AAAA,eACG6H,eAAe,EADlB,eAEE;AAAA,gBAAK,iBAAgB7H,YAAY,CAAC0B,aAAc,MAAK1B,YAAY,CAACuB,cAAe;AAAjF;AAAA;AAAA;AAAA;AAAA,YAFF,EAGGvB,YAAY,CAAC0B,aAAb,KAA+B1B,YAAY,CAACuB,cAA5C,gBACC;AAAG,MAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD,gBAGC;AACE,MAAA,SAAS,EAAC,wBADZ;AAEE,MAAA,OAAO,EAAE+C,SAFX;AAGE,MAAA,QAAQ,EAAElE,SAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YANJ,EAcGE,cAAc,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAdrB,EAeGJ,KAAK,CAACmC,MAAN,GAAe,CAAf,IAAoBsF,iBAAiB,EAfxC;AAAA;AAAA;AAAA;AAAA;AAAA,UAFJ;AAqBD,CA9WD;;GAAM7H,Y;;KAAAA,Y;AAgXN,eAAeA,YAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Connection, PublicKey } from '@solana/web3.js';\r\nimport { Program, Provider, web3 } from '@project-serum/anchor';\r\nimport { MintLayout, TOKEN_PROGRAM_ID, Token } from '@solana/spl-token';\r\nimport { programs } from '@metaplex/js';\r\nimport './CandyMachine.css';\r\nimport CountdownTimer from '../CountdownTimer';\r\nimport {\r\n  candyMachineProgram,\r\n  TOKEN_METADATA_PROGRAM_ID,\r\n  SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\r\n} from './helpers';\r\nconst {\r\n  metadata: { Metadata, MetadataProgram },\r\n} = programs;\r\n\r\nconst config = new web3.PublicKey(process.env.REACT_APP_CANDY_MACHINE_CONFIG);\r\nconst { SystemProgram } = web3;\r\nconst opts = {\r\n  preflightCommitment: 'processed',\r\n};\r\n\r\nconst MAX_NAME_LENGTH = 32;\r\nconst MAX_URI_LENGTH = 200;\r\nconst MAX_SYMBOL_LENGTH = 10;\r\nconst MAX_CREATOR_LEN = 32 + 1 + 1;\r\n\r\n\r\n\r\nconst CandyMachine = ({ walletAddress }) => {\r\n  const [machineStats, setMachineStats] = useState(null);\r\n  const [mints, setMints] = useState([]);\r\n  const [isMinting, setIsMinting] = useState(false);\r\n  const [isLoadingMints, setIsLoadingMints] = useState(false);\r\n\r\n  // Actions\r\n  useEffect(() => {\r\n    getCandyMachineState();\r\n  }, []);\r\n\r\n  const getProvider = () => {\r\n    const rpcHost = process.env.REACT_APP_SOLANA_RPC_HOST;\r\n    // Create a new connection object\r\n    const connection = new Connection(rpcHost);\r\n    \r\n    // Create a new Solana provider object\r\n    const provider = new Provider(\r\n      connection,\r\n      window.solana,\r\n      opts.preflightCommitment\r\n    );\r\n  \r\n    return provider;\r\n  };  \r\n\r\n\r\n  // Declare getCandyMachineState as an async method\r\nconst getCandyMachineState = async () => { \r\n  const provider = getProvider();\r\n  // Get metadata about your deployed candy machine program\r\n  const idl = await Program.fetchIdl(candyMachineProgram, provider);\r\n  // Create a program that you can call\r\n  const program = new Program(idl, candyMachineProgram, provider);\r\n  // Fetch the metadata from your candy machine\r\n  const candyMachine = await program.account.candyMachine.fetch(\r\n    process.env.REACT_APP_CANDY_MACHINE_ID\r\n  );\r\n  \r\n  // Parse out all our metadata and log it out\r\n  const itemsAvailable = candyMachine.data.itemsAvailable.toNumber();\r\n  const itemsRedeemed = candyMachine.itemsRedeemed.toNumber();\r\n  const itemsRemaining = itemsAvailable - itemsRedeemed;\r\n  const goLiveData = candyMachine.data.goLiveDate.toNumber();\r\n\r\n  // We will be using this later in our UI so let's generate this now\r\n  const goLiveDateTimeString = `${new Date(\r\n    goLiveData * 1000\r\n  ).toLocaleDateString()} @ ${new Date(\r\n    goLiveData * 1000\r\n  ).toLocaleTimeString()}`;\r\n\r\n  setMachineStats({\r\n    itemsAvailable,\r\n    itemsRedeemed,\r\n    itemsRemaining,\r\n    goLiveData,\r\n    goLiveDateTimeString,\r\n  });\r\n\r\n  console.log({\r\n    itemsAvailable,\r\n    itemsRedeemed,\r\n    itemsRemaining,\r\n    goLiveData,\r\n    goLiveDateTimeString,\r\n  });\r\n\r\n  setIsLoadingMints(true);\r\n\r\n  const data = await fetchHashTable(\r\n    process.env.REACT_APP_CANDY_MACHINE_ID,\r\n    true\r\n  );\r\n  \r\n  if (data.length !== 0) {\r\n    for (const mint of data) {\r\n      // Get URI\r\n      const response = await fetch(mint.data.uri);\r\n      const parse = await response.json();\r\n      console.log(\"Past Minted NFT\", mint)\r\n  \r\n      // Get image URI\r\n      if (!mints.find((mint) => mint === parse.image)) {\r\n        setMints((prevState) => [...prevState, parse.image]);\r\n      }\r\n    }\r\n  }\r\n\r\n  setIsLoadingMints(false);\r\n\r\n};\r\n\r\n  const fetchHashTable = async (hash, metadataEnabled) => {\r\n    const connection = new web3.Connection(\r\n      process.env.REACT_APP_SOLANA_RPC_HOST\r\n    );\r\n\r\n    const metadataAccounts = await MetadataProgram.getProgramAccounts(\r\n      connection,\r\n      {\r\n        filters: [\r\n          {\r\n            memcmp: {\r\n              offset:\r\n                1 +\r\n                32 +\r\n                32 +\r\n                4 +\r\n                MAX_NAME_LENGTH +\r\n                4 +\r\n                MAX_URI_LENGTH +\r\n                4 +\r\n                MAX_SYMBOL_LENGTH +\r\n                2 +\r\n                1 +\r\n                4 +\r\n                0 * MAX_CREATOR_LEN,\r\n              bytes: hash,\r\n            },\r\n          },\r\n        ],\r\n      }\r\n    );\r\n\r\n    const mintHashes = [];\r\n\r\n    for (let index = 0; index < metadataAccounts.length; index++) {\r\n      const account = metadataAccounts[index];\r\n      const accountInfo = await connection.getParsedAccountInfo(account.pubkey);\r\n      const metadata = new Metadata(hash.toString(), accountInfo.value);\r\n      if (metadataEnabled) mintHashes.push(metadata.data);\r\n      else mintHashes.push(metadata.data.mint);\r\n    }\r\n\r\n    return mintHashes;\r\n  };\r\n\r\n  const getMetadata = async (mint) => {\r\n    return (\r\n      await PublicKey.findProgramAddress(\r\n        [\r\n          Buffer.from('metadata'),\r\n          TOKEN_METADATA_PROGRAM_ID.toBuffer(),\r\n          mint.toBuffer(),\r\n        ],\r\n        TOKEN_METADATA_PROGRAM_ID\r\n      )\r\n    )[0];\r\n  };\r\n\r\n  const getMasterEdition = async (mint) => {\r\n    return (\r\n      await PublicKey.findProgramAddress(\r\n        [\r\n          Buffer.from('metadata'),\r\n          TOKEN_METADATA_PROGRAM_ID.toBuffer(),\r\n          mint.toBuffer(),\r\n          Buffer.from('edition'),\r\n        ],\r\n        TOKEN_METADATA_PROGRAM_ID\r\n      )\r\n    )[0];\r\n  };\r\n\r\n  const getTokenWallet = async (wallet, mint) => {\r\n    return (\r\n      await web3.PublicKey.findProgramAddress(\r\n        [wallet.toBuffer(), TOKEN_PROGRAM_ID.toBuffer(), mint.toBuffer()],\r\n        SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID\r\n      )\r\n    )[0];\r\n  };\r\n\r\n  const mintToken = async () => {\r\n    try {\r\n      setIsMinting(true);\r\n      const mint = web3.Keypair.generate();\r\n      const token = await getTokenWallet(\r\n        walletAddress.publicKey,\r\n        mint.publicKey\r\n      );\r\n      const metadata = await getMetadata(mint.publicKey);\r\n      const masterEdition = await getMasterEdition(mint.publicKey);\r\n      const rpcHost = process.env.REACT_APP_SOLANA_RPC_HOST;\r\n      const connection = new Connection(rpcHost);\r\n      const rent = await connection.getMinimumBalanceForRentExemption(\r\n        MintLayout.span\r\n      );\r\n\r\n      const accounts = {\r\n        config,\r\n        candyMachine: process.env.REACT_APP_CANDY_MACHINE_ID,\r\n        payer: walletAddress.publicKey,\r\n        wallet: process.env.REACT_APP_TREASURY_ADDRESS,\r\n        mint: mint.publicKey,\r\n        metadata,\r\n        masterEdition,\r\n        mintAuthority: walletAddress.publicKey,\r\n        updateAuthority: walletAddress.publicKey,\r\n        tokenMetadataProgram: TOKEN_METADATA_PROGRAM_ID,\r\n        tokenProgram: TOKEN_PROGRAM_ID,\r\n        systemProgram: SystemProgram.programId,\r\n        rent: web3.SYSVAR_RENT_PUBKEY,\r\n        clock: web3.SYSVAR_CLOCK_PUBKEY,\r\n      };\r\n\r\n      const signers = [mint];\r\n      const instructions = [\r\n        web3.SystemProgram.createAccount({\r\n          fromPubkey: walletAddress.publicKey,\r\n          newAccountPubkey: mint.publicKey,\r\n          space: MintLayout.span,\r\n          lamports: rent,\r\n          programId: TOKEN_PROGRAM_ID,\r\n        }),\r\n        Token.createInitMintInstruction(\r\n          TOKEN_PROGRAM_ID,\r\n          mint.publicKey,\r\n          0,\r\n          walletAddress.publicKey,\r\n          walletAddress.publicKey\r\n        ),\r\n        createAssociatedTokenAccountInstruction(\r\n          token,\r\n          walletAddress.publicKey,\r\n          walletAddress.publicKey,\r\n          mint.publicKey\r\n        ),\r\n        Token.createMintToInstruction(\r\n          TOKEN_PROGRAM_ID,\r\n          mint.publicKey,\r\n          token,\r\n          walletAddress.publicKey,\r\n          [],\r\n          1\r\n        ),\r\n      ];\r\n\r\n      const provider = getProvider();\r\n      const idl = await Program.fetchIdl(candyMachineProgram, provider);\r\n      const program = new Program(idl, candyMachineProgram, provider);\r\n\r\n      const txn = await program.rpc.mintNft({\r\n        accounts,\r\n        signers,\r\n        instructions,\r\n      });\r\n\r\n      console.log('txn:', txn);\r\n\r\n      // Setup listener\r\n      connection.onSignatureWithOptions(\r\n        txn,\r\n        async (notification, context) => {\r\n          if (notification.type === 'status') {\r\n            console.log('Receievd status event');\r\n\r\n            const { result } = notification;\r\n            if (!result.err) {\r\n              console.log('NFT Minted!');\r\n              setIsMinting(false);\r\n              await getCandyMachineState();\r\n            }\r\n          }\r\n        },\r\n        { commitment: 'processed' }\r\n      );\r\n    } catch (error) {\r\n      let message = error.msg || 'Minting failed! Please try again!';\r\n      setIsMinting(false);\r\n      if (!error.msg) {\r\n        if (error.message.indexOf('0x138')) {\r\n        } else if (error.message.indexOf('0x137')) {\r\n          message = `SOLD OUT!`;\r\n        } else if (error.message.indexOf('0x135')) {\r\n          message = `Insufficient funds to mint. Please fund your wallet.`;\r\n        }\r\n      } else {\r\n        if (error.code === 311) {\r\n          message = `SOLD OUT!`;\r\n        } else if (error.code === 312) {\r\n          message = `Minting period hasn't started yet.`;\r\n        }\r\n      }\r\n\r\n      console.warn(message);\r\n    }\r\n  };\r\n\r\n  const createAssociatedTokenAccountInstruction = (\r\n    associatedTokenAddress,\r\n    payer,\r\n    walletAddress,\r\n    splTokenMintAddress\r\n  ) => {\r\n    const keys = [\r\n      { pubkey: payer, isSigner: true, isWritable: true },\r\n      { pubkey: associatedTokenAddress, isSigner: false, isWritable: true },\r\n      { pubkey: walletAddress, isSigner: false, isWritable: false },\r\n      { pubkey: splTokenMintAddress, isSigner: false, isWritable: false },\r\n      {\r\n        pubkey: web3.SystemProgram.programId,\r\n        isSigner: false,\r\n        isWritable: false,\r\n      },\r\n      { pubkey: TOKEN_PROGRAM_ID, isSigner: false, isWritable: false },\r\n      {\r\n        pubkey: web3.SYSVAR_RENT_PUBKEY,\r\n        isSigner: false,\r\n        isWritable: false,\r\n      },\r\n    ];\r\n    return new web3.TransactionInstruction({\r\n      keys,\r\n      programId: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\r\n      data: Buffer.from([]),\r\n    });\r\n  };\r\n\r\n  const renderMintedItems = () => (\r\n    <div className=\"gif-container\">\r\n      <p className=\"sub-text\">Minted Items ✨</p>\r\n      <div className=\"gif-grid\">\r\n        {mints.map((mint) => (\r\n          <div className=\"gif-item\" key={mint}>\r\n            <img src={mint} alt={`Minted NFT ${mint}`} />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\nconst renderDropTimer = () => {\r\n  // Get the current date and dropDate in a JavaScript Date object\r\n  const currentDate = new Date();\r\n  const dropDate = new Date(machineStats.goLiveData * 1000);\r\n\r\n  // If currentDate is before dropDate, render our Countdown component\r\n  if (currentDate < dropDate) {\r\n    return <CountdownTimer dropDate={dropDate} />;\r\n  }\r\n    return <p>{`Drop Date: ${machineStats.goLiveDateTimeString}`}</p>;\r\n  };\r\n\r\n  return (\r\n    machineStats && (\r\n      <div className=\"machine-container\">\r\n        {renderDropTimer()}\r\n        <p>{`Items Minted: ${machineStats.itemsRedeemed} / ${machineStats.itemsAvailable}`}</p>\r\n        {machineStats.itemsRedeemed === machineStats.itemsAvailable ? (\r\n          <p className=\"sub-text\">Sold Out 🙊</p>\r\n        ) : (\r\n          <button\r\n            className=\"cta-button mint-button\"\r\n            onClick={mintToken}\r\n            disabled={isMinting}\r\n          >\r\n            Mint NFT\r\n          </button>\r\n        )}\r\n        {isLoadingMints && <p>LOADING MINTS...</p>}\r\n        {mints.length > 0 && renderMintedItems()}\r\n      </div>\r\n    )\r\n  );\r\n};\r\n\r\nexport default CandyMachine;\r\n"]},"metadata":{},"sourceType":"module"}